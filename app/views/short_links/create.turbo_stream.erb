<% if @short_link&.persisted? %>
  <turbo-stream target="form_response" action="update">
    <template>
      <div class="p-4 rounded-3 border border-success-subtle bg-success-subtle">
        <p class="mb-2 fw-semibold text-success">âœ… Your short link:</p>
        <div class="d-flex flex-column flex-md-row align-items-stretch gap-2" data-controller="clipboard">
          <input type="text" class="form-control bg-white border-success" value="<%= redirect_short_url(@short_link.short_code) %>" id="shortLinkDisplay" readonly data-clipboard-target="source">
          <button class="btn btn-outline-success fw-semibold" data-action="clipboard#copy">Copy</button>
        </div>
      </div>
    </template>
  </turbo-stream>
<% else %>
  <turbo-stream target="form_response" action="update">
    <template>
      <div class="alert alert-danger text-start">
        <strong class="d-block mb-2">There was a problem creating your short link:</strong>
        <ul class="mb-0 ps-3">
          <% if @short_link&.errors&.any? %>
            <% @short_link.errors.full_messages.each do |msg| %>
              <li><%= msg %></li>
            <% end %>
          <% elsif defined?(@error_message) && @error_message.present? %>
            <li><%= @error_message %></li>
          <% else %>
            <li>Unknown error occurred. Please try again.</li>
          <% end %>
        </ul>
      </div>
    </template>
  </turbo-stream>
<% end %>
